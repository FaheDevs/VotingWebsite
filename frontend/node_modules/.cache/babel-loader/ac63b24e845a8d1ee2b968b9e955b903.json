{"ast":null,"code":"const axios = require('axios');\n\nconst instance = axios.create({\n  baseURL: 'http://localhost:3000/api/'\n});\nconsole.log('trying to login');\nlet refreshToken;\ninstance.interceptors.response.use(response => {\n  return response;\n}, async error => {\n  const originalRequest = error.config;\n\n  if (error.config.url != '/refreshToken' && error.response.status === 401 && originalRequest._retry !== true) {\n    originalRequest._retry = true;\n\n    if (refreshToken && refreshToken != '') {\n      instance.defaults.headers.common['authorization'] = `Bearer ${refreshToken}`;\n      console.log('refresh token');\n      await instance.post('/refreshToken').then(response => {\n        instance.defaults.headers.common['authorization'] = `Bearer ${response.data.accessToken}`;\n        originalRequest.headers['authorization'] = `Bearer ${response.data.accessToken}`;\n      }).catch(error => {\n        console.log(error.response.status);\n        refreshToken = null;\n      });\n      return instance(originalRequest);\n    }\n  }\n});\nexport default instance;","map":{"version":3,"names":["axios","require","instance","create","baseURL","console","log","refreshToken","interceptors","response","use","error","originalRequest","config","url","status","_retry","defaults","headers","common","post","then","data","accessToken","catch"],"sources":["/Users/walidaddouche/Desktop/courseact/src/utils/client.js"],"sourcesContent":["const axios = require('axios');\nconst instance = axios.create({\n    baseURL: 'http://localhost:3000/api/',\n});\n\nconsole.log('trying to login');\n\nlet refreshToken;\n\n\ninstance.interceptors.response.use((response) => {\n    return response;\n}, async (error) => {\n    const originalRequest = error.config;\n    if (error.config.url != '/refreshToken' && error.response.status === 401 && originalRequest._retry !== true) {\n        originalRequest._retry = true;\n        if (refreshToken && refreshToken != '') {\n            instance.defaults.headers.common['authorization'] = `Bearer ${refreshToken}`;\n            console.log('refresh token');\n            await instance.post('/refreshToken').then((response) => {\n                instance.defaults.headers.common['authorization'] = `Bearer ${response.data.accessToken}`;\n                originalRequest.headers['authorization'] = `Bearer ${response.data.accessToken}`;\n            }).catch((error) => {\n                console.log(error.response.status);\n                refreshToken = null;\n            });\n            return instance(originalRequest);\n        }\n    }\n});\n\nexport default instance;"],"mappings":"AAAA,MAAMA,KAAK,GAAGC,OAAO,CAAC,OAAD,CAArB;;AACA,MAAMC,QAAQ,GAAGF,KAAK,CAACG,MAAN,CAAa;EAC1BC,OAAO,EAAE;AADiB,CAAb,CAAjB;AAIAC,OAAO,CAACC,GAAR,CAAY,iBAAZ;AAEA,IAAIC,YAAJ;AAGAL,QAAQ,CAACM,YAAT,CAAsBC,QAAtB,CAA+BC,GAA/B,CAAoCD,QAAD,IAAc;EAC7C,OAAOA,QAAP;AACH,CAFD,EAEG,MAAOE,KAAP,IAAiB;EAChB,MAAMC,eAAe,GAAGD,KAAK,CAACE,MAA9B;;EACA,IAAIF,KAAK,CAACE,MAAN,CAAaC,GAAb,IAAoB,eAApB,IAAuCH,KAAK,CAACF,QAAN,CAAeM,MAAf,KAA0B,GAAjE,IAAwEH,eAAe,CAACI,MAAhB,KAA2B,IAAvG,EAA6G;IACzGJ,eAAe,CAACI,MAAhB,GAAyB,IAAzB;;IACA,IAAIT,YAAY,IAAIA,YAAY,IAAI,EAApC,EAAwC;MACpCL,QAAQ,CAACe,QAAT,CAAkBC,OAAlB,CAA0BC,MAA1B,CAAiC,eAAjC,IAAqD,UAASZ,YAAa,EAA3E;MACAF,OAAO,CAACC,GAAR,CAAY,eAAZ;MACA,MAAMJ,QAAQ,CAACkB,IAAT,CAAc,eAAd,EAA+BC,IAA/B,CAAqCZ,QAAD,IAAc;QACpDP,QAAQ,CAACe,QAAT,CAAkBC,OAAlB,CAA0BC,MAA1B,CAAiC,eAAjC,IAAqD,UAASV,QAAQ,CAACa,IAAT,CAAcC,WAAY,EAAxF;QACAX,eAAe,CAACM,OAAhB,CAAwB,eAAxB,IAA4C,UAAST,QAAQ,CAACa,IAAT,CAAcC,WAAY,EAA/E;MACH,CAHK,EAGHC,KAHG,CAGIb,KAAD,IAAW;QAChBN,OAAO,CAACC,GAAR,CAAYK,KAAK,CAACF,QAAN,CAAeM,MAA3B;QACAR,YAAY,GAAG,IAAf;MACH,CANK,CAAN;MAOA,OAAOL,QAAQ,CAACU,eAAD,CAAf;IACH;EACJ;AACJ,CAnBD;AAqBA,eAAeV,QAAf"},"metadata":{},"sourceType":"module"}